
<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <title>Calculator Comision Agent - Multiple Înregistrări</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .credit-entry { border: 1px solid #ccc; padding: 10px; margin-bottom: 10px; }
        input, select { margin: 5px; padding: 5px; }
        button { margin: 10px; padding: 10px; }
        .result { margin-top: 15px; font-weight: bold; }
    </style>
</head>
<body>
    <h2>Calculator Comision Agent - Multiple Înregistrări</h2>
    <div id="credits-container"></div>
    <button onclick="adaugaCredit()">Adaugă Înregistrare</button>
    <button onclick="calculeazaToate()">Calculează Comisioane</button>
    <div class="result" id="rezultate"></div>

    <script>
        let count = 0;

        function adaugaCredit() {
            count++;
            const container = document.getElementById('credits-container');
            const entry = document.createElement('div');
            entry.className = 'credit-entry';
            entry.innerHTML = `
                <h4>Credit ${count}</h4>
                <label>Banca:</label>
                <select id="banca_${count}">
                    <option value="UCFIN">UCFIN</option>
                    <option value="FIRST">FIRST</option>
                    <option value="GARANTI">GARANTI</option>
                    <option value="BT">BT</option>
                    <option value="BCR">BCR</option>
                    <option value="ALPHA">ALPHA</option>
                    <option value="ING">ING</option>
                    <option value="UNICREDIT">UNICREDIT</option>
                </select><br>
                <label>Tip Credit:</label>
                <select id="tip_credit_${count}">
                    <option value="REF NP">REF NP</option>
                    <option value="NP">NP</option>
                    <option value="IP">IP</option>
                    <option value="REF IP">REF IP</option>
                </select><br>
                <label>Suma Credit (RON):</label>
                <input type="number" id="suma_${count}" placeholder="Introduceți suma"><br>
                <label>Sursa Lead:</label>
                <select id="sursa_${count}">
                    <option value="Recomandari">Recomandari</option>
                    <option value="TeoCredit">TeoCredit</option>
                    <option value="Agent Imobiliar">Agent Imobiliar</option>
                </select><br>
            `;
            container.appendChild(entry);
        }

        function calculeazaToate() {
            const grila = {
                'UCFIN_REF NP_CATEGORIA 1': 2.0,
                'FIRST_NP_CATEGORIA 2': 1.0,
                'GARANTI_NP_CATEGORIA 1': 1.2,
                'GARANTI_IP_CATEGORIA 2': 0.4,
                'GARANTI_REF IP_CATEGORIA 2': 0.4,
                'GARANTI_IP_CATEGORIA 1': 1.2,
                'BT_REF IP_CATEGORIA 1': 0.8,
                'BT_REF IP_CATEGORIA 2': 0.4,
                'BT_IP_CATEGORIA 2': 0.4,
                'BCR_IP_CATEGORIA 2': 0.4,
                'BCR_REF NP_CATEGORIA 2': 1.0, // ✅ Adăugat pentru BCR_REF NP_CATEGORIA 2
                'BCR_REF NP_CATEGORIA 2': 1.0,
                'ALPHA_IP_CATEGORIA 2': 0.4,
                'ING_IP_CATEGORIA 2': 0.4,
                'UNICREDIT_IP_CATEGORIA 2': 0.4,
                'UNICREDIT_IP_CATEGORIA 1': 1.2
            };

            let total = 0;
            let rezultatHTML = '<h3>Rezultate</h3><table border="1"><tr><th>Nr</th><th>Banca</th><th>Tip Credit</th><th>Suma</th><th>Sursa</th><th>Procent</th><th>Comision</th></tr>';

            for (let i = 1; i <= count; i++) {
                const banca = document.getElementById(`banca_${i}`).value.toUpperCase();
                const tipCredit = document.getElementById(`tip_credit_${i}`).value.toUpperCase();
                const suma = parseFloat(document.getElementById(`suma_${i}`).value) || 0;
                const sursa = document.getElementById(`sursa_${i}`).value.toLowerCase();
                
                let categorie = '';
                if (sursa.includes('teocredit')) categorie = 'CATEGORIA 2';
                else if (sursa.includes('agent')) categorie = 'CATEGORIA 3';
                else categorie = 'CATEGORIA 1';
                
                const key = `${banca}_${tipCredit}_${categorie}`;
                const procent = grila[key] || 0;
                const comision = (suma * procent / 100).toFixed(2);
                total += parseFloat(comision);

                rezultatHTML += `<tr><td>${i}</td><td>${banca}</td><td>${tipCredit}</td><td>${suma}</td><td>${sursa}</td><td>${procent}%</td><td>${comision} RON</td></tr>`;
            }

            rezultatHTML += `<tr><td colspan="6"><strong>Total</strong></td><td><strong>${total.toFixed(2)} RON</strong></td></tr></table>`;
            document.getElementById('rezultate').innerHTML = rezultatHTML;
        }
    </script>
</body>
</html>
