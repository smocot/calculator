<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <title>Calculator Comision - Transparent</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Roboto', sans-serif; background-color: #f8f9fa; margin: 20px; color: #333; }
        h2 { text-align: center; color: #4CAF50; }
        .credit-entry { background-color: #fff; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); padding: 15px; margin-bottom: 15px; width: 300px; }
        input, select { width: 100%; margin: 5px 0; padding: 8px; border: 1px solid #ddd; border-radius: 4px; }
        button { background-color: #4CAF50; color: white; padding: 10px 20px; margin: 10px 5px; border: none; border-radius: 4px; cursor: pointer; transition: background 0.3s; }
        button:hover { background-color: #45a049; }
        .result { margin-top: 20px; background-color: #fff; padding: 15px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: center; }
        th { background-color: #4CAF50; color: white; }
        tr:nth-child(even) { background-color: #f2f2f2; }
    </style>
</head>
<body>
    <h2>Calculator Comision - Transparent</h2>
    <div id="form-container" class="credit-entry">
        <label>Nume Client:</label>
        <input type="text" id="nume" placeholder="Introduceți numele">
        <label>Banca:</label>
        <select id="banca">
            <option value="BCR">BCR</option><option value="GARANTI">GARANTI</option><option value="UNICREDIT">UNICREDIT</option>
            <option value="BT">BT</option><option value="PATRIA">PATRIA</option><option value="ALPHA">ALPHA</option>
            <option value="ING">ING</option><option value="RAIF">RAIF</option><option value="BRD">BRD</option>
            <option value="LIBRA">LIBRA</option><option value="FIRST">FIRST</option><option value="CREDIT EUROPE">CREDIT EUROPE</option>
            <option value="UCFIN">UCFIN</option>
        </select>
        <label>Tip Credit:</label>
        <select id="tip_credit">
            <option value="IP">IP</option><option value="REF IP">REF IP</option><option value="NP">NP</option><option value="REF NP">REF NP</option>
        </select>
        <label>Suma (RON):</label>
        <input type="number" id="suma" placeholder="Introduceți suma">
        <label>Sursa Lead:</label>
        <select id="sursa">
            <option value="Recomandari">Recomandari</option><option value="TeoCredit">TeoCredit</option><option value="Agent Imobiliar">Agent Imobiliar</option>
        </select>
        <button onclick="adaugaCredit()">Adaugă Înregistrare</button>
    </div>
    <button onclick="calculeazaToate()">Calculează Comisioane</button>
    <div class="result" id="listaInregistrari"></div>
    <div class="result" id="totaluriCumulative"></div>
    <div class="result" id="rezultate"></div>

    <script>
        const praguri = {
            'BCR': [{ prag: 800000, procent: 0.8 }, { prag: 1600000, procent: 0.9 }, { prag: Infinity, procent: 1.0 }],
            'GARANTI': [{ prag: 800000, procent: 0.8 }, { prag: 1600000, procent: 0.9 }, { prag: Infinity, procent: 1.2 }],
            'UNICREDIT': [{ prag: 800000, procent: 0.8 }, { prag: 1600000, procent: 0.9 }, { prag: Infinity, procent: 1.2 }],
            'BT': [{ prag: 800000, procent: 0.8 }],
            'PATRIA': [{ prag: 800000, procent: 1.0 }],
            'ALPHA': [{ prag: Infinity, procent: 0.4 }],
            'ING': [{ prag: Infinity, procent: 0.4 }],
            'RAIF': [{ prag: 800000, procent: 0.8 }],
            'BRD': [{ prag: 800000, procent: 0.8 }],
            'LIBRA': [{ prag: 800000, procent: 0.8 }],
            'FIRST': [{ prag: 800000, procent: 0.8 }],
            'CREDIT EUROPE': [{ prag: 800000, procent: 0.8 }],
            'UCFIN': [{ prag: 800000, procent: 2.0 }]
        };

        let inregistrari = [];

        function adaugaCredit() {
            const nume = document.getElementById('nume').value || "N/A";
            const banca = document.getElementById('banca').value;
            const tip = document.getElementById('tip_credit').value;
            const suma = parseFloat(document.getElementById('suma').value) || 0;
            const sursa = document.getElementById('sursa').value;
            const categorie = sursa.toLowerCase().includes("teocredit") ? 2 : (sursa.toLowerCase().includes("agent") ? 3 : 1);
            inregistrari.push({nume,banca,tip,suma,sursa,categorie});
            document.getElementById('nume').value = ""; document.getElementById('suma').value = "";
            afiseazaInregistrari();
        }

        function afiseazaInregistrari() {
            let html = '<h3>Inregistrări Introduse</h3><table><tr><th>Nr</th><th>Nume</th><th>Banca</th><th>Tip</th><th>Suma</th><th>Sursa</th></tr>';
            inregistrari.forEach((r,i)=>{ html+=`<tr><td>${i+1}</td><td>${r.nume}</td><td>${r.banca}</td><td>${r.tip}</td><td>${r.suma}</td><td>${r.sursa}</td></tr>`; });
            html+='</table>';
            document.getElementById('listaInregistrari').innerHTML = html;
        }

        function calculeazaToate() {
            const totalPeBanca = {};
            inregistrari.forEach(r => {
                if (!totalPeBanca[r.banca]) totalPeBanca[r.banca] = {1:0,2:0,3:0};
                totalPeBanca[r.banca][r.categorie] += r.suma;
            });

            let totaluriHTML = '<h3>Totaluri Cumulative și Praguri</h3><table><tr><th>Banca</th><th>Categorie</th><th>Total Sume</th><th>Procent Aplicat</th></tr>';
            const procenteMax = {};
            for (const banca in totalPeBanca) {
                procenteMax[banca] = {};
                [1,3].forEach(cat => {
                    let procent = 0;
                    praguri[banca].forEach(p => { if (totalPeBanca[banca][cat] >= p.prag) procent = p.procent; });
                    procenteMax[banca][cat] = procent;
                    totaluriHTML+=`<tr><td>${banca}</td><td>${cat}</td><td>${totalPeBanca[banca][cat]}</td><td>${procent}%</td></tr>`;
                });
            }
            totaluriHTML+='</table>';
            document.getElementById('totaluriCumulative').innerHTML = totaluriHTML;

            let total = 0, html = '<h3>Rezultate</h3><table><tr><th>Nr</th><th>Nume</th><th>Banca</th><th>Tip</th><th>Suma</th><th>Sursa</th><th>Procent</th><th>Comision</th></tr>';
            inregistrari.forEach((r,i)=>{
                let procent=r.categorie===2?0.4:procenteMax[r.banca][r.categorie]||praguri[r.banca][0].procent;
                if(r.banca==='UNICREDIT' && r.suma<250000) procent=0;
                let comision=(r.suma*procent/100).toFixed(2); total+=parseFloat(comision);
                html+=`<tr><td>${i+1}</td><td>${r.nume}</td><td>${r.banca}</td><td>${r.tip}</td><td>${r.suma}</td><td>${r.sursa}</td><td>${procent}%</td><td>${comision} RON</td></tr>`;
            });
            html+=`<tr><td colspan="7"><strong>Total</strong></td><td><strong>${total.toFixed(2)} RON</strong></td></tr></table>`;
            document.getElementById('rezultate').innerHTML = html;
        }
    </script>
</body>
</html>
